<footer class="py-5 bg-success bg-opacity-10">
      <div class="container-lg">
        <div class="row">
          <div class="col-lg-3 col-md-6 col-sm-6 mb-4">
            <div class="footer-menu">
              <img src="<?= base_url('assets/assets_dashboard/images/logo.svg') ?>" width="150" height="120" alt="Fresh Station Logo" class="mb-3">
              <p class="text-muted">Fresh Station adalah supermarket yang menyediakan produk segar berkualitas tinggi langsung dari petani dan supplier terpercaya.</p>
              <div class="social-links mt-3">
                <ul class="d-flex list-unstyled gap-2">
                  <li>
                    <a href="https://www.tiktok.com/@freshstationsupermarket" class="btn btn-outline-success rounded-circle">
                      <i class="fab fa-tiktok"></i>
                    </a>
                  </li>
                  <li>
                    <a href="https://www.instagram.com/freshstationsupermarket/" class="btn btn-outline-success rounded-circle">
                      <i class="fab fa-instagram"></i>
                    </a>
                  </li>
                  <li>
                    <a href="https://api.whatsapp.com/send/?phone=6282260590569&text&type=phone_number&app_absent=0" class="btn btn-outline-success rounded-circle">
                      <i class="fab fa-whatsapp"></i>
                    </a>
                  </li>
                </ul>
              </div>
            </div>
          </div>

          <div class="col-md-3 col-sm-6 mb-4">
            <div class="footer-menu">
              <h5 class="widget-title text-success fw-bold mb-4">Tentang Kami</h5>
              <ul class="menu-list list-unstyled">
                <li class="menu-item mb-2">
                  <a href="<?= base_url('pages/about') ?>" class="nav-link text-muted"><i class="fas fa-angle-right text-success me-2"></i>Tentang Fresh Station</a>
                </li>
                <li class="menu-item mb-2">
                  <a href="#" class="nav-link text-muted"><i class="fas fa-angle-right text-success me-2"></i>Cara Berbelanja</a>
                </li>
                <li class="menu-item mb-2">
                  <a href="#" class="nav-link text-muted"><i class="fas fa-angle-right text-success me-2"></i>Blog & Artikel</a>
                </li>
                <li class="menu-item mb-2">
                  <a href="#" class="nav-link text-muted"><i class="fas fa-angle-right text-success me-2"></i>Karir</a>
                </li>
                <li class="menu-item mb-2">
                  <a href="#" class="nav-link text-muted"><i class="fas fa-angle-right text-success me-2"></i>Mitra Fresh Station</a>
                </li>
              </ul>
            </div>
          </div>

          <div class="col-md-3 col-sm-6 mb-4">
            <div class="footer-menu">
              <h5 class="widget-title text-success fw-bold mb-4">Layanan Pelanggan</h5>
              <ul class="menu-list list-unstyled">
                <li class="menu-item mb-2">
                  <a href="#" class="nav-link text-muted"><i class="fas fa-angle-right text-success me-2"></i>Bantuan</a>
                </li>
                <li class="menu-item mb-2">
                  <a href="#" class="nav-link text-muted"><i class="fas fa-angle-right text-success me-2"></i>Metode Pembayaran</a>
                </li>
                <li class="menu-item mb-2">
                  <a href="#" class="nav-link text-muted"><i class="fas fa-angle-right text-success me-2"></i>Lacak Pesanan</a>
                </li>
                <li class="menu-item mb-2">
                  <a href="#" class="nav-link text-muted"><i class="fas fa-angle-right text-success me-2"></i>Pengembalian & Refund</a>
                </li>
                <li class="menu-item mb-2">
                  <a href="#" class="nav-link text-muted"><i class="fas fa-angle-right text-success me-2"></i>Kebijakan Privasi</a>
                </li>
              </ul>
            </div>
          </div>

          <div class="col-lg-3 col-md-6 col-sm-6 mb-4">
            <div class="footer-menu">
              <h5 class="widget-title text-success fw-bold mb-4">Newsletter</h5>
              <p class="text-muted">Dapatkan info produk terbaru dan promo spesial Fresh Station.</p>
              <form class="newsletter-form mt-4">
                <div class="input-group">
                  <input type="email" class="form-control border-success bg-transparent" placeholder="Email Anda" aria-label="Email Address">
                  <button class="btn btn-success" type="submit">
                    <i class="fas fa-paper-plane"></i>
                  </button>
                </div>
              </form>
              <div class="mt-4">
                <h6 class="text-success fw-bold mb-3">Jam Operasional</h6>
                <p class="text-muted mb-0">Senin - Minggu: 07:00 - 22:00</p>
                <p class="text-muted">Customer Service: 07:00 - 20:00</p>
              </div>
            </div>
          </div>
          
        </div>
      </div>
    </footer>

    <div id="footer-bottom" class="py-3 bg-success text-white">
      <div class="container-lg">
        <div class="row align-items-center">
          <div class="col-md-6 copyright">
            <p class="mb-0">Â© <?= date('Y') ?> Fresh Station. All rights reserved.</p>
          </div>
          <div class="col-md-6 text-md-end mt-3 mt-md-0">
            <div class="payment-methods">
              <div class="row g-2 align-items-center justify-content-end">
                <div class="col-auto">
                  <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/a/a2/Logo_QRIS.svg/2560px-Logo_QRIS.svg.png" 
                       alt="QRIS" class="payment-logo" height="25">
                </div>
                <div class="col-auto">
                  <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/e/eb/Logo_ovo_purple.svg/2560px-Logo_ovo_purple.svg.png" 
                       alt="OVO" class="payment-logo" height="25">
                </div>
                <div class="col-auto">
                  <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/8/86/Gopay_logo.svg/1024px-Gopay_logo.svg.png" 
                       alt="GoPay" class="payment-logo" height="25">
                </div>
                <div class="col-auto">
                  <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/5/5c/Bank_Central_Asia.svg/1280px-Bank_Central_Asia.svg.png" 
                       alt="BCA" class="payment-logo" height="25">
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <style>
        .payment-methods {
          padding: 10px;
          border-radius: 8px;
        }
        .payment-logo {
          filter: brightness(0) invert(1);
          opacity: 0.9;
          transition: opacity 0.2s;
        }
        .payment-logo:hover {
          opacity: 1;
        }
      </style>
    </div>

    <script src="<?php echo base_url() ?>assets/assets_dashboard/js/jquery-1.11.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe" crossorigin="anonymous"></script>
    <script src="<?php echo base_url() ?>assets/assets_dashboard/js/plugins.js"></script>
    <script src="<?php echo base_url() ?>assets/assets_dashboard/js/script.js"></script>

    <script>
document.addEventListener('DOMContentLoaded', function() {
    // Live Chat Functionality
    const liveChatBtn = document.getElementById('liveChatBtn');
    const chatModal = document.getElementById('chatModal');
    const closeChatBtn = document.getElementById('closeChatBtn');
    const chatInput = document.getElementById('chatInput');
    const sendMessageBtn = document.getElementById('sendMessageBtn');
    const chatMessages = document.getElementById('chatMessages');
    const unreadBadge = liveChatBtn.querySelector('.unread-badge');

    // Load chat history when page loads
    function loadInitialMessages() {
        fetch('<?= base_url('customer/chat/get_messages') ?>', {
            headers: {
                'X-Requested-With': 'XMLHttpRequest'
            }
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                chatMessages.innerHTML = ''; // Clear existing messages
                data.messages.forEach(msg => {
                    appendMessage(msg);
                });
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }
        })
        .catch(error => console.error('Error loading messages:', error));
    }

    // Toggle chat modal
    liveChatBtn.addEventListener('click', () => {
        chatModal.classList.toggle('chat-modal-hidden'); // Gunakan toggle
        if (!chatModal.classList.contains('chat-modal-hidden')) {
            loadInitialMessages();
            unreadBadge.classList.add('chat-modal-hidden'); // Sembunyikan badge
        }
    });

    closeChatBtn.addEventListener('click', () => {
        chatModal.classList.add('chat-modal-hidden'); // Tambahkan class untuk menutup
    });

    // Single unified send message function
    function sendMessage() {
        const message = chatInput.value.trim();
        if (!message) return;

        // Clear input immediately
        chatInput.value = '';

        // Send to server
        fetch('<?= base_url('customer/chat/send_message') ?>', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'X-Requested-With': 'XMLHttpRequest'
            },
            body: JSON.stringify({ message: message })
        })
        .then(response => response.json())
        .then(data => {
            if (data.success && data.data) {
                // Append message only after successful send
                appendMessage(data.data);
                chatMessages.scrollTop = chatMessages.scrollHeight;
            } else {
                if (data.message === 'Please login first') {
                    window.location.href = '<?= base_url('login') ?>';
                }
                console.error('Failed to send message:', data.message);
            }
        })
        .catch(error => console.error('Error:', error));
    }

    // Load messages function
    function loadMessages() {
        fetch('<?= base_url('customer/chat/get_messages') ?>', {
            headers: {
                'X-Requested-With': 'XMLHttpRequest'
            }
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                updateChatMessages(data.messages);
            } else if (data.message === 'Please login first') {
                window.location.href = '<?= base_url('login') ?>';
            }
        })
        .catch(error => console.error('Error:', error));
    }

    // Update chat messages without clearing existing ones
    function updateChatMessages(newMessages) {
        const existingMessageIds = new Set(
            Array.from(chatMessages.children).map(el => el.dataset.messageId)
        );

        newMessages.forEach(msg => {
            if (!existingMessageIds.has(msg.id?.toString())) {
                appendMessage(msg);
            }
        });

        chatMessages.scrollTop = chatMessages.scrollHeight;
    }

    // Check for unread messages
    function checkUnreadMessages() {
        fetch('<?= base_url('customer/chat/get_unread_count') ?>', {
            headers: {
                'X-Requested-With': 'XMLHttpRequest'
            }
        })
        .then(response => response.json())
        .then(data => {
            if (data.unread_count > 0) {
                unreadBadge.classList.remove('chat-modal-hidden');
                unreadBadge.textContent = data.unread_count;
            } else {
                unreadBadge.classList.add('chat-modal-hidden');
            }
        })
        .catch(error => console.error('Error:', error));
    }

    // Append message to chat
    function appendMessage(messageData) {
        const div = document.createElement('div');
        div.className = `message ${messageData.from_type}`;
        if (messageData.id) {
            div.dataset.messageId = messageData.id;
        }
        
        const time = messageData.created_at ? new Date(messageData.created_at) : new Date();
        const formattedTime = time.toLocaleTimeString('id-ID', { 
            hour: '2-digit', 
            minute: '2-digit' 
        });

        div.innerHTML = `
            ${messageData.message}
            <div class="time">${formattedTime}</div>
        `;
        chatMessages.appendChild(div);
        chatMessages.scrollTop = chatMessages.scrollHeight;
    }

    // Event listeners
    sendMessageBtn.addEventListener('click', sendMessage);
    chatInput.addEventListener('keypress', (e) => {
        if (e.key === 'Enter') {
            e.preventDefault();
            sendMessage();
        }
    });

    // Load initial messages
    loadInitialMessages();

    // Set up periodic updates
    setInterval(() => {
        if (chatModal.style.display === 'block') {
            loadMessages();
        }
        checkUnreadMessages();
    }, 5000);
});
</script>

  </body>
</html>